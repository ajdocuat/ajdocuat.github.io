<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>ajDBRunStoredProc function · AlchemyJ</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="# ajDBRunStoredProc function"/><meta name="docsearch:version" content="4.1"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="ajDBRunStoredProc function · AlchemyJ"/><meta property="og:type" content="website"/><meta property="og:url" content="//"/><meta property="og:description" content="# ajDBRunStoredProc function"/><meta property="og:image" content="/img/undraw_online.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="/img/undraw_tweetstorm.svg"/><link rel="shortcut icon" href="/img/favicon.ico"/><link rel="stylesheet" href="/css/atom-one-dark-reasonable.css"/><script src="/js/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100}
          )
        });
        </script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="https://www.alchemyj.io" id="siteSubject1" target="_self"><span id="siteSubject2">Alchemy</span><span id="siteSubject3">J</span></a><span id="siteSubject4"> by</span><span> </span><a href="http://www.axisoft.com" rel="noopener noreferrer" data-type="external" data-content="http://www.axisoft.com" id="siteSubject5" target="_blank">Axisoft</a><a href="/versions"><h3>4.1</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"></ul></nav></div></header></div></div><div class="navPusher singleRowMobileNav"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Database Operation</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Get Started<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/4.1/GetStarted/Overview">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/GetStarted/Prerequisites">Prerequisites</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/GetStarted/Install">Install AlchemyJ</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/GetStarted/RequestAndInstallLicense">Request and Install License</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/GetStarted/WriteYourFirstRESTAPI">Write Your First REST API</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/GetStarted/PreviewYourFirstRESTAPI">Preview Your First REST API</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/GetStarted/GenerateAndRunYourRESTAPI">Generate and Run Your REST API</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/GetStarted/GoingFurther">Going Further</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Terms &amp; Concepts<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/4.1/TerminologyAndConcepts/TerminologyAndConcepts">Terms and Concepts</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Recipe Book<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/4.1/RecipeBook/Recipes">Recipes</a></li><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Database Operation</h4><ul><li class="navListItem"><a class="navItem" href="/docs/4.1/RecipeBook/DatabaseOperation/AccessingDatabase">Accessing Database</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/RecipeBook/DatabaseOperation/SingleTableMaintenance">Single Table Maintenance</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">File Operation</h4><ul><li class="navListItem"><a class="navItem" href="/docs/4.1/RecipeBook/FileOperation/ReadAndWriteTextFile">Reading and Writing Text Files</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/RecipeBook/FileOperation/ReadAndWriteExcelWorkbook">Reading and Writing Excel Workbook</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/RecipeBook/FileOperation/UploadAndDownloadFileInDB">Uploading and Downloading File in Database</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">External API Integration</h4><ul><li class="navListItem"><a class="navItem" href="/docs/4.1/RecipeBook/ExternalAPIIntegration/InvokingExternalAPI">Making Web Service Requests</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/RecipeBook/ExternalAPIIntegration/CallingExternalJavaFunction">Calling External Java Functions</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Data Validation</h4><ul><li class="navListItem"><a class="navItem" href="/docs/4.1/RecipeBook/DataValidation/DataValidationBackend">Data Validation (Backend)</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/RecipeBook/DataValidation/DataValidationUI">Data Validation (UI)</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Data Handling</h4><ul><li class="navListItem"><a class="navItem" href="/docs/4.1/RecipeBook/DataHandling/ReturningMultipleCells">Returning Multiple Cells</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/RecipeBook/DataHandling/ConstructingJSON">Constructing JSON</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/RecipeBook/DataHandling/ParsingJSON">Parsing JSON</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/RecipeBook/DataHandling/ConstructingXML">Constructing XML</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Access Control</h4><ul><li class="navListItem"><a class="navItem" href="/docs/4.1/RecipeBook/AccessControl/AuthenticationWithLdap">Authentication with LDAP</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/RecipeBook/AccessControl/AuthenticationForRESTAPI">Authentication for REST API</a></li></ul></div><li class="navListItem"><a class="navItem" href="/docs/4.1/RecipeBook/SendingEmail">Sending Email</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/RecipeBook/ConfigurationExternalization">Reading External Configuration</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/RecipeBook/ErrorHandling">Error Handling</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/RecipeBook/WorkingOnMultipleWorkbooks">Team Development using AlchemyJ</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/RecipeBook/PerformanceNOptimization">Improving Performance</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Development<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/4.1/Development/Guideline">Guideline</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Development/AlchemyJStudio">AlchemyJ Studio</a></li><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">AlchemyJ Workbook</h4><ul><li class="navListItem"><a class="navItem" href="/docs/4.1/Development/AlchemyJWorkbook/Introduction">Introduction</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Development/AlchemyJWorkbook/CreateAlchemyJWorkbook">Create AlchemyJ Workbook</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Development/AlchemyJWorkbook/SysRuntime">System Runtime Worksheet</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Development/AlchemyJWorkbook/AppConfig">Application Configuration Worksheet</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Development/AlchemyJWorkbook/JavaAPIPackage">Java API Package Worksheet</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Development/AlchemyJWorkbook/JavaAPIClass">Java API Class Worksheet</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Development/AlchemyJWorkbook/RESTAPI">REST API Worksheet</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Development/AlchemyJWorkbook/RESTEndpointGroup">REST API Endpoint Group Worksheet</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Development/AlchemyJWorkbook/RESTLoginService">REST API Login Service Worksheet</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Development/AlchemyJWorkbook/RESTTokenAuthorization">REST API Token Authorization Worksheet</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Development/AlchemyJWorkbook/RESTUserDetailService">REST API User Details Service Worksheet</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Development/AlchemyJWorkbook/RESTEndpointSecurity">REST API Endpoint Security Worksheet</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Development/AlchemyJWorkbook/DBSchema">DB Schema Worksheet</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Development/AlchemyJWorkbook/DataDictionary">Data Dictionary Worksheet</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Development/AlchemyJWorkbook/ExternalResources">External Resources Worksheet</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Development/AlchemyJWorkbook/DataRelationshipSchema">Data Relationship Schema Snippet</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Development/AlchemyJWorkbook/FilterCondition">Filter Condition Snippet</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Development/AlchemyJWorkbook/LOBInfo">LOB Info Snippet</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Development/AlchemyJWorkbook/SortingCriteria">Sorting Criteria Snippet</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Development/AlchemyJWorkbook/SQLParameters">SQL Parameters Snippet</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Business Logic</h4><ul><li class="navListItem"><a class="navItem" href="/docs/4.1/Development/BusinessLogic/DefineBusinessLogic">Define Business Logic</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Development/BusinessLogic/BusinessModelingBestPractice">Business Modeling Best Practice</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Java API</h4><ul><li class="navListItem"><a class="navItem" href="/docs/4.1/Development/JavaAPI/DefineJavaAPIClass">Define Java API Class</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Development/JavaAPI/DefineJavaAPIPackage">Define Java API Package</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Development/JavaAPI/IntegrateJavaAPIWithJavaProject">Integrate Java API in a Java project</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">REST API</h4><ul><li class="navListItem"><a class="navItem" href="/docs/4.1/Development/RESTAPI/DefineRESTAPIEndpointGroup">Define REST API Endpoint Group</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Development/RESTAPI/DefineRESTAPI">Define REST API</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Development/RESTAPI/EnableRESTSecurity">Enable REST API Security</a></li></ul></div><li class="navListItem"><a class="navItem" href="/docs/4.1/Development/GenerateAPI">Generate API</a></li><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">OpenAPI Spec for REST API</h4><ul><li class="navListItem"><a class="navItem" href="/docs/4.1/Development/OpenAPISpecForRESTAPI/Introduction">Introduction</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Development/OpenAPISpecForRESTAPI/EnableOpenAPISpec">Enable OpenAPI Specification Generation</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Development/OpenAPISpecForRESTAPI/OpenAPISpecContentSource">OpenAPI Specification Content Source</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Development/OpenAPISpecForRESTAPI/TryYourRESTAPI">Try Your REST API</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Testing<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/4.1/Testing/Introduction">Introduction</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Testing/TestTemplate">Test Template</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Testing/UsingTestTemplate">Using Test Template</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Troubleshooting<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/4.1/Troubleshooting/InspectorSettings">API Inspector Settings</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Troubleshooting/UsingAPIInspector">Using API Inspector</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Reference<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/4.1/Reference/AJExtendedFunctions/Index">Index</a></li><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Database Operation</h4><ul><li class="navListItem navListItemActive"><a class="navItem" href="/docs/4.1/Reference/AJExtendedFunctions/ajDBRunStoredProc">ajDBRunStoredProc</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Reference/AJExtendedFunctions/ajDBRunSQL">ajDBRunSQL</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Reference/AJExtendedFunctions/ajDBCreateRecord">ajDBCreateRecord</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Reference/AJExtendedFunctions/ajDBCountRecord">ajDBCountRecord</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Reference/AJExtendedFunctions/ajDBReadRecord">ajDBReadRecord</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Reference/AJExtendedFunctions/ajDBUpdateRecord">ajDBUpdateRecord</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Reference/AJExtendedFunctions/ajDBMergeRecord">ajDBMergeRecord</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Reference/AJExtendedFunctions/ajDBDeleteRecord">ajDBDeleteRecord</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Reference/AJExtendedFunctions/ajDBUpdateLOB">ajDBUpdateLOB</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Reference/AJExtendedFunctions/ajDBGetLOB">ajDBGetLOB</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">File Operation</h4><ul><li class="navListItem"><a class="navItem" href="/docs/4.1/Reference/AJExtendedFunctions/ajFileExists">ajFileExists</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Reference/AJExtendedFunctions/ajReadFile">ajReadFile</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Reference/AJExtendedFunctions/ajRenameFile">ajRenameFile</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Reference/AJExtendedFunctions/ajCopyFile">ajCopyFile</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Reference/AJExtendedFunctions/ajMoveFile">ajMoveFile</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Reference/AJExtendedFunctions/ajWriteFile">ajWriteFile</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Reference/AJExtendedFunctions/ajDeleteFile">ajDeleteFile</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Reference/AJExtendedFunctions/ajReadWorkbook">ajReadWorkbook</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Reference/AJExtendedFunctions/ajWriteWorkbook">ajWriteWorkbook</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">External API Integration</h4><ul><li class="navListItem"><a class="navItem" href="/docs/4.1/Reference/AJExtendedFunctions/ajCustomFunction">ajCustomFunction</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Reference/AJExtendedFunctions/ajWebServiceREST">ajWebServiceREST</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Reference/AJExtendedFunctions/ajWebServiceSOAP">ajWebServiceSOAP</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">JSON &amp; XML Handling</h4><ul><li class="navListItem"><a class="navItem" href="/docs/4.1/Reference/AJExtendedFunctions/ajJSONPath">ajJSONPath</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Reference/AJExtendedFunctions/ajJSON">ajJSON</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Reference/AJExtendedFunctions/ajJSONFromSchema">ajJSONFromSchema</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Reference/AJExtendedFunctions/ajJSONFromTable">ajJSONFromTable</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Reference/AJExtendedFunctions/ajJSONToTable">ajJSONToTable</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Reference/AJExtendedFunctions/ajXML">ajXML</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Reference/AJExtendedFunctions/ajXMLFromSchema">ajXMLFromSchema</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Reference/AJExtendedFunctions/ajXMLFromTable">ajXMLFromTable</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">LDAP Function</h4><ul><li class="navListItem"><a class="navItem" href="/docs/4.1/Reference/AJExtendedFunctions/ajLDAPLogin">ajLDAPLogin</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Reference/AJExtendedFunctions/ajLDAPGroupMembers">ajLDAPGroupMembers</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Reference/AJExtendedFunctions/ajLDAPUserDetails">ajLDAPUserDetails</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Reference/AJExtendedFunctions/ajLDAPUserInGroups">ajLDAPUserInGroups</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Reference/AJExtendedFunctions/ajLDAPUserList">ajLDAPUserList</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Common Function</h4><ul><li class="navListItem"><a class="navItem" href="/docs/4.1/Reference/AJExtendedFunctions/ajBigNumber">ajBigNumber</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Reference/AJExtendedFunctions/ajBigString">ajBigString</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Reference/AJExtendedFunctions/ajCheckDataItem">ajCheckDataItem</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Reference/AJExtendedFunctions/ajSendEmail">ajSendEmail</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Reference/AJExtendedFunctions/ajFilter">ajFilter</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Reference/AJExtendedFunctions/ajSort">ajSort</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Reference/AJExtendedFunctions/ajRegExpCount">ajRegExpCount</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Reference/AJExtendedFunctions/ajRegExpMatch">ajRegExpMatch</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Reference/AJExtendedFunctions/ajAddress">ajAddress</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Reference/AJExtendedFunctions/ajLastUsedCell">ajLastUsedCell</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Reference/AJExtendedFunctions/ajUsedRange">ajUsedRange</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Reference/AJExtendedFunctions/ajDBType">ajDBType</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Error Handling</h4><ul><li class="navListItem"><a class="navItem" href="/docs/4.1/Reference/AJExtendedFunctions/ajRaiseError">ajRaiseError</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Reference/AJExtendedFunctions/ajModelError">ajModelError</a></li><li class="navListItem"><a class="navItem" href="/docs/4.1/Reference/AJExtendedFunctions/ajSystemError">ajSystemError</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Supported Excel Functions</h4><ul><li class="navListItem"><a class="navItem" href="/docs/4.1/Reference/SupportedExcelFunctions">Supported Excel Functions</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">FAQ<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/4.1/Faq/Faq">FAQ</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"></header><article><div><span><h1><a class="anchor" aria-hidden="true" id="ajdbrunstoredproc-function"></a><a href="#ajdbrunstoredproc-function" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ajDBRunStoredProc function</h1>
<h2><a class="anchor" aria-hidden="true" id="description"></a><a href="#description" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Description</h2>
<p>The ajDBRunStoredProc function executes a stored procedure and returns the result.</p>
<h2><a class="anchor" aria-hidden="true" id="syntax"></a><a href="#syntax" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Syntax</h2>
<p>ajDBRunStoredProc(stored_procedure_name, [parameter], [return_type], [transpose], [return_header], [data_source_id], [convert_to_text], [run_condition], [run_by_function_point_only])</p>
<table>
<thead>
<tr><th><strong>Argument Name</strong></th><th>Argument Type</th><th><strong>Description</strong></th></tr>
</thead>
<tbody>
<tr><td>stored_procedure_name  <br/>(required)</td><td>Variant</td><td>Specify the name of the stored procedure to execute.</td></tr>
<tr><td>parameter <br/>(optional)</td><td>Double</td><td><strong>Option 1</strong><br />The range of cells to form the list of  input and output parameters to be specified in the following format. The range of cells can span across multiple rows and columns. The parameter sequence needs to be matched with the sequence of stored procedure.<br />&lt;field_name&gt;-##-&lt;value&gt;-##-&lt;data_type&gt;-##-&lt;in_out_flag&gt;-||-<br />&lt;field_name&gt;-##--&lt;value&gt;-##-&lt;data_type&gt;-##-&lt;in_out_flag&gt;-||-...<br /><br />Where,<br />   <br />-||- denotes AlchemyJ parameter separator.<br/>-##- denotes AlchemyJ parameter type  separator.<br /><br />For example,  <br />RECORD_ID1-##-21-##-NUMBER-##-IN-||-RECORD_ID2-##-23-##-<br />NUMBER-##-IN-||-OUTPUT -##--##- NUMBER -##- OUT<br /><br />Notes:<br/>1. The default  value for in_out_flag is 'IN'. <br />2. When date_type is Date, only 'yyyy/MM/dd' and 'MM/dd/yyyy' date format are supported.<br />3. Both separator symbols can be configured in <a href="../../Development/AlchemyJWorkbook/AppConfig">%%AppConfig Worksheet</a>. If you do not specify anything, the default value will always be an empty string (“”).<br /><br /><strong>Option 2</strong><br />Refer to the <a href="../../Development/AlchemyJWorkbook/SQLParameters">SQLParameters Snippet</a> to see how to use this snippet to define the required fields.</td></tr>
<tr><td>return_type  <br/>(optional)</td><td>Double</td><td>0 indicates the function will return a set of records (in cell array).  <br />1 indicates the function will return the output parameters.  <br />2 indicates to return the number of the affected records, only works for stored procedure with SQL select statement. <br />If you do not specify anything, the default value will always be 0.</td></tr>
<tr><td>transpose  <br/>(optional)</td><td>Boolean</td><td>If it equals TRUE, the return result will be transposed.  This only affects the return that has multiple cells. If you do not specify anything, the default value will always be FALSE.</td></tr>
<tr><td>return_header <br/>(optional)</td><td>Boolean</td><td>If it equals TRUE, the return result will include the column headers as the first row.  <br />If it equals FALSE, the return result will contain data only. <br />This only applies when ‘return_type’ is 0. <br />If you do not specify anything, the default value will always be FALSE.</td></tr>
<tr><td>data_source_id <br/>(optional)</td><td>String</td><td><p>Specify the data  source ID. The parameter is used to define which database should be executed  for the function.</p>If you do not specify anything, the default value will always  be 'primary'.</td></tr>
<tr><td>convert_to_text <br/>(optional)</td><td>Boolean</td><td>If it equals TRUE, the return result will be converted to string values.  If it equals FALSE, the return result will preserve the original data type.    <br />If you do not specify anything, the  default value will always be FALSE.</td></tr>
<tr><td>run_condition <br/>(optional)</td><td>Boolean</td><td><p>The function will run when the value is TRUE. Otherwise, it will not run. </p>If you do not specify anything, the default  value will always be TRUE.</td></tr>
<tr><td>run_by_function_point_only <br/>(optional)</td><td>Boolean</td><td><p>If it equals FALSE, the function can be executed through ‘Excel Calculation’ (can be either <strong>Automatic</strong> or <strong>Manual</strong>, <strong>Calculate Now</strong> or <strong>Calculate Sheet</strong>) or <strong>Preview Function Point</strong>. </p><p>If it equals TRUE, the function can be executed with <strong>Preview Function Point</strong> (AlchemyJ toolbar \ Preview Function Point) only.</p>If you do not specify anything, the default value will always be TRUE.</td></tr>
</tbody>
</table>
<p>The function will return:</p>
<ol>
<li>Content type: Database operations results or the count</li>
<li>Method: Within a cell / cell array</li>
</ol>
<p>Before using ajDBRunStoredProc, the database connection must be set up from the <a href="../../Development/AlchemyJStudio#properties">Properties</a> dialog box.</p>
<h2><a class="anchor" aria-hidden="true" id="example"></a><a href="#example" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example</h2>
<p>This example uses the following stored procedure. The output result is the sum of parameter 1 and parameter 2.</p>
<p><a href="ajDBRunStoredProcImg/image-01.png"><img src="ajDBRunStoredProcImg/image-01.png" alt=""></a></p>
<p>In this example, it sets p1 as 20 and p2 as 10. Then parameter was set as 'p1-##-20-##-number-##-IN-||-p2-##-10-##-number-##-IN-||-p3-##--##-number-##-OUT' and the return_type is 1 since it returns the output parameter.</p>
<p><a href="ajDBRunStoredProcImg/image-02.png"><img src="ajDBRunStoredProcImg/image-02.png" alt=""></a></p>
<p>Please note that the parameter sequence needs to be matched with the sequence of stored procedure. When there has some optional paramters no need to be inputted, then use empty input for the optional parameter if it is in the middle. For example, p2 is an optional parameter, then the parameter should be set as 'p1-##-20-##-number-##-IN-||-p2-||-p3-##--##-number-##-OUT'.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/4.1/Reference/AJExtendedFunctions/Index"><span class="arrow-prev">← </span><span>Index</span></a><a class="docs-next button" href="/docs/4.1/Reference/AJExtendedFunctions/ajDBRunSQL"><span class="function-name-prevnext">ajDBRunSQL</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#description">Description</a></li><li><a href="#syntax">Syntax</a></li><li><a href="#example">Example</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap" id="site_map"><table align="center" border="0"><tbody><tr><td align="right" id="copyrightTd"><span height="46px" id="copyright">Copyright © 2019 <a href="http://www.axisoft.com" target="_blank" data-content="http://www.axisoft.com" data-type="external" rel="noopener noreferrer" id="copyrightLink"> Axisoft.</a> All Rights Reserved.</span></td></tr></tbody></table></section></footer></div></body></html>